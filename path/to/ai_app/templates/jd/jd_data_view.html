                                // 发送数据到千问API进行分析
                                console.log('准备调用 QwenChat API，载荷：', {
                                    content: `以下是京东电商数据中${selectedDate}及前3天（${dates.join(', ')}）的数据……`,
                                    system_role: systemRoleSnippet,
                                    model: 'deepseek-r1-distill-llama-70b'
                                });
                                return fetch("{% url 'qwen-chat-api' %}", {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                                    },
                                    body: JSON.stringify({
                                        'content': analysisPrompt,
                                        'system_role': systemRoleSnippet,
                                        'model': 'deepseek-r1-distill-llama-70b'
                                    })
                                })
                                .then(response => {
                                    console.log('QwenChat API 返回状态', response.status);
                                    if (!response.ok) {
                                        throw new Error(`服务器返回错误状态: ${response.status}`);
                                    }
                                    return response.json();
                                })
                                .then(data => {
                                    console.log('QwenChat API 返回数据', data);
                                    if (data.error) {
                                        throw new Error(data.error);
                                    }
                                    const analysisContent = document.getElementById('analysisContent');
                                    if (data.text) {
                                        analysisContent.innerHTML = data.text.replace(/\n/g, '<br>');
                                    } else {
                                        analysisContent.innerHTML = '暂无分析结果';
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    document.getElementById('analysisContent').innerHTML =
                                      `数据分析请求失败: ${error.message}。<br><br>请联系管理员解决后端API问题。`;
                                }); 